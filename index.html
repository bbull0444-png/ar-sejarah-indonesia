<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Sejarah Indonesia</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }

        #info-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 1000; display: none;
            align-items: center; justify-content: center; padding: 20px; pointer-events: none;
        }
        #info-overlay.show { display: flex; pointer-events: auto; }

        #info-content {
            background: white; border-radius: 15px; padding: 30px;
            max-width: 800px; max-height: 70vh; overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        #info-content h1 { color: #8B4513; margin-bottom: 20px; font-size: 28px; text-align: center; }
        #info-content h2 { color: #A0522D; margin-top: 20px; margin-bottom: 10px; font-size: 20px; }
        #info-content p, #info-content li { color: #333; line-height: 1.8; margin-bottom: 15px; font-size: 15px; }
        #info-content ul { margin-left: 20px; }

        #close-info {
            display: block; margin: 25px auto 0; padding: 12px 40px;
            background: #8B4513; color: white; border: none; border-radius: 25px;
            font-size: 16px; cursor: pointer; font-weight: bold; transition: background 0.3s;
        }
        #close-info:hover { background: #A0522D; }

        #instructions {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(139,69,19,0.9); color: white; padding: 15px 30px;
            border-radius: 30px; z-index: 998; text-align: center; font-size: 14px;
            max-width: 90%; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        #touch-hint {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(139,69,19,0.9); color: white; padding: 12px 25px;
            border-radius: 25px; z-index: 998; text-align: center; font-size: 13px;
            max-width: 90%; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .loading {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%);
            color: white; font-size: 18px; z-index: 997;
            background: rgba(0,0,0,0.7); padding: 20px 40px; border-radius: 10px;
        }

        @media (max-width: 768px) {
            #info-content { padding: 20px; }
            #info-content h1 { font-size: 22px; }
            #info-content h2 { font-size: 18px; }
            #info-content p, #info-content li { font-size: 14px; }
            #touch-hint { font-size: 12px; padding: 10px 20px; }
        }
    </style>
</head>
<body>
    <div id="info-overlay"><div id="info-content"></div></div>
    <div id="instructions">ğŸ“· Arahkan kamera ke barcode marker (0-9)</div>
    <div id="touch-hint">ğŸ‘† Drag untuk putar model 360Â° (semua arah)</div>
    <div class="loading" id="loading">Memuat AR...</div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;" vr-mode-ui="enabled: false" renderer="logarithmicDepthBuffer: true; precision: medium; antialias: true;" loading-screen="enabled: false">
        
        <a-entity camera></a-entity>

        <!-- Barcode 0: Borobudur -->
        <a-marker type="barcode" value="0" id="marker-borobudur">
            <a-entity class="ar-model" data-object="borobudur" gltf-model="url(Borobudur.glb)" scale="1 1 1" position="0 0.5 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 1: Prasasti Ciaruteun -->
        <a-marker type="barcode" value="1" id="marker-prasasti">
            <a-entity class="ar-model" data-object="prasasti" gltf-model="url(models/prasasti-ciaruteun.glb)" scale="0.5 0.5 0.5" position="0 0.3 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 2: Dolmen -->
        <a-marker type="barcode" value="2" id="marker-dolmen">
            <a-entity class="ar-model" data-object="dolmen" gltf-model="url(models/dolmen.glb)" scale="0.8 0.8 0.8" position="0 0.4 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 3: Arca Buddha -->
        <a-marker type="barcode" value="3" id="marker-arca">
            <a-entity class="ar-model" data-object="arca" gltf-model="url(models/arca-buddha.glb)" scale="0.6 0.6 0.6" position="0 0.3 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 4: Kjokkenmoddinger -->
        <a-marker type="barcode" value="4" id="marker-kjokken">
            <a-entity class="ar-model" data-object="kjokken" gltf-model="url(models/kjokkenmoddinger.glb)" scale="0.4 0.4 0.4" position="0 0.2 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 5: Menhir -->
        <a-marker type="barcode" value="5" id="marker-menhir">
            <a-entity class="ar-model" data-object="menhir" gltf-model="url(models/menhir.glb)" scale="0.7 0.7 0.7" position="0 0.4 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 6: Prambanan -->
        <a-marker type="barcode" value="6" id="marker-prambanan">
            <a-entity class="ar-model" data-object="prambanan" gltf-model="url(models/prambanan.glb)" scale="1 1 1" position="0 0.5 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 7: Brahma -->
        <a-marker type="barcode" value="7" id="marker-brahma">
            <a-entity class="ar-model" data-object="brahma" gltf-model="url(models/brahma.glb)" scale="0.5 0.5 0.5" position="0 0.3 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 8: Meganthropus -->
        <a-marker type="barcode" value="8" id="marker-meganthropus">
            <a-entity class="ar-model" data-object="meganthropus" gltf-model="url(models/meganthropus.glb)" scale="0.4 0.4 0.4" position="0 0.3 0" rotation="-90 0 0"></a-entity>
        </a-marker>

        <!-- Barcode 9: Homo Erectus -->
        <a-marker type="barcode" value="9" id="marker-homo">
            <a-entity class="ar-model" data-object="homo" gltf-model="url(models/homo-erectus.glb)" scale="0.4 0.4 0.4" position="0 0.3 0" rotation="-90 0 0"></a-entity>
        </a-marker>
    </a-scene>

    <script>
        const scene = document.querySelector('a-scene');
        const loading = document.querySelector('#loading');
        const infoOverlay = document.getElementById('info-overlay');
        const infoContent = document.getElementById('info-content');
        
        let currentRotation = {x: -90, y: 0, z: 0};
        let activeModel = null;
        let isDragging = false;
        let previousMouseX = 0;
        let previousMouseY = 0;
        let markerVisible = false;

        const objInfo = {
            borobudur: {
                title: "ğŸ•Œ Candi Borobudur (Barcode 0)",
                html: '<p><strong>Candi Borobudur</strong> dibangun pada masa Dinasti Syailendra sekitar tahun <strong>780â€“830 M</strong> oleh Raja Samaratungga dengan arsitek Gunadharma.</p><p>Nama Borobudur dari kata <em>Vihara Buddha Uhr</em> (biara Buddha di atas bukit). Dibangun setinggi 34,5 meter dengan 2 juta balok batu andesit tanpa semen, menggunakan sistem <strong>interlocking</strong>.</p><h2>Struktur</h2><ul><li><strong>Kamadhatu</strong> - dunia nafsu (160 relief karma)</li><li><strong>Rupadhatu</strong> - dunia bentuk (1.300 relief, 432 arca Buddha)</li><li><strong>Arupadhatu</strong> - dunia tanpa bentuk (72 stupa berlubang)</li></ul><p>Bentuk dari atas menyerupai <strong>mandala</strong>, melambangkan perjalanan spiritual menuju nirwana.</p>'
            },
            prasasti: {
                title: "ğŸ“œ Prasasti Ciaruteun (Barcode 1)",
                html: '<p>Prasasti peninggalan <strong>Kerajaan Tarumanegara</strong> ditemukan di Cibungbulang, Bogor.</p><h2>Struktur</h2><ul><li><strong>Inskripsi A:</strong> 4 baris aksara Pallawa bahasa Sanskerta</li><li><strong>Inskripsi B:</strong> 1 baris, belum terbaca jelas</li></ul><h2>Makna</h2><p>Terdapat gambar <strong>sepasang telapak kaki Raja Purnawarman</strong> yang disamakan dengan kaki Dewa Wisnu sebagai penghormatan.</p>'
            },
            dolmen: {
                title: "ğŸª¨ Dolmen (Barcode 2)",
                html: '<p>Dari bahasa Breton: "dol" (meja) + "men" (batu). Meja batu besar dari batu tegak penyangga dan batu datar di atasnya.</p><h2>Fungsi</h2><ul><li>Tempat sesaji untuk arwah nenek moyang</li><li>Penutup kubur batu</li></ul><h2>Lokasi</h2><p>Bondowoso, Puger (Jawa Timur), Paseman (Sumsel), Sumba (NTT)</p><p>Menunjukkan <strong>stratifikasi sosial</strong> - hanya tokoh penting dikuburkan dengan Dolmen.</p>'
            },
            arca: {
                title: "ğŸ™ Arca Buddha (Barcode 3)",
                html: '<h2>Ciri Fisik</h2><ul><li><strong>Ushnisha</strong> - ubun menonjol, pencapaian spiritual</li><li><strong>Urna</strong> - bulu di alis, kebijaksanaan</li><li><strong>Telinga panjang</strong> - kemajuan spiritual</li><li><strong>Mata setengah terpejam</strong> - ketenangan</li></ul><h2>Dharmacakra Mudra</h2><p><strong>Dharma</strong> (kebenaran) + <strong>Chakra</strong> (roda) = "Pemutaran Roda Dharma", ajaran pertama Buddha setelah pencerahan.</p><p>Telunjuk menyentuh ibu jari membentuk lingkaran (roda dharma). 3 jari tegak = <strong>Tri Ratna</strong>: Buddha, Dharma, Sangha.</p>'
            },
            kjokken: {
                title: "ğŸš Kjokkenmoddinger (Barcode 4)",
                html: '<p>Dari Denmark: "kjokken" (dapur) + "modding" (sampah). Tumpukan kulit kerang manusia purba tepi pantai masa Mesolitikum.</p><h2>Ciri-ciri</h2><ul><li>Tumpukan kulit kerang/siput</li><li>Alat batu sederhana (kapak genggam)</li><li>Pola berburu dan meramu</li><li>Di pesisir pantai/muara sungai</li></ul><h2>Lokasi di Indonesia</h2><p>Sumatra Utara (Lhok Seumawe, Medan), Sumatra Timur (Langsa, Binjai)</p><p>Bukti kehidupan <strong>semi-nomaden</strong> bergantung hasil laut.</p>'
            },
            menhir: {
                title: "ğŸ—¿ Menhir (Barcode 5)",
                html: '<p>Batu tegak megalitik sebagai penghormatan leluhur dan simbol arwah dalam upacara keagamaan prasejarah.</p><h2>Fungsi</h2><ul><li>Batu peringatan dan tanda kubur</li><li>Medium pemujaan roh nenek moyang</li><li>Simbol hubungan manusia-dunia spiritual</li></ul><h2>Transformasi</h2><p>Pada Islamisasi Maluku (Kerajaan Hitu), batu tegak diadaptasi jadi <strong>nisan makam Islam</strong>.</p><p>Menunjukkan <strong>akulturasi</strong> Islam dengan tradisi megalitik - penghormatan leluhur tetap terjaga.</p>'
            },
            prambanan: {
                title: "ğŸ›• Candi Prambanan (Barcode 6)",
                html: '<p>Dibangun era <strong>Kerajaan Mataram Kuno</strong> (abad 8-10). Terdiri <strong>240 struktur candi</strong>.</p><h2>Sejarah</h2><p>Dimulai oleh <strong>Rakai Pikatan</strong>, diresmikan <strong>778 Saka (856 M)</strong> oleh Rakai Kayuwangi.</p><h2>Arsitektur</h2><p>Berdasarkan <strong>Prasasti Siwagraha</strong>, didedikasikan untuk <strong>Trimurti</strong> (Wisnu, Brahma, Siwa). Mengikuti pola <strong>mandala</strong> dan bentuk <strong>Gunung Mahameru</strong>.</p><p>Struktur mencerminkan kosmologi Hindu tiga loka (ranah alam semesta).</p>'
            },
            brahma: {
                title: "ğŸ”± Dewa Brahma (Barcode 7)",
                html: '<p>Dewa pencipta alam semesta dalam <strong>Trimurti</strong> (Brahma pencipta, Wisnu pemelihara, Siwa pelebur).</p><h2>Ciri Fisik</h2><ul><li><strong>4 wajah</strong> ke 4 penjuru - penguasaan 4 Veda</li><li><strong>4 tangan:</strong> teratai (penciptaan), mala (waktu), kitab (pengetahuan), mudra (berkah)</li></ul><h2>Filosofi</h2><p><strong>Nirguna Brahman:</strong> Tuhan tak berwujud<br><strong>Saguna Brahman:</strong> Tuhan berwujud</p><p>Brahma = manifestasi Saguna Brahman dalam fungsi penciptaan.</p>'
            },
            meganthropus: {
                title: "ğŸ¦´ Meganthropus Paleojavanicus (Barcode 8)",
                html: '<p>Manusia purba tertua di Indonesia, fosil ditemukan di <strong>Sangiran</strong> oleh <strong>von Koenigswald (1937-1941)</strong>. Hidup <strong>1-2 juta tahun lalu</strong>.</p><h2>Ciri Fisik</h2><ul><li>Tinggi Â±2,5 m, postur besar kokoh</li><li>Otak Â±900 cc</li><li>Dahi tebal, tulang pipi kuat</li><li>Gigi geraham besar kuat</li><li>Berjalan membungkuk</li><li>Tangan lebih panjang dari kaki</li></ul><h2>Kehidupan</h2><p><strong>Nomaden</strong>, herbivora (umbi, akar, biji). Ditemukan alat batu sederhana (kapak genggam).</p>'
            },
            homo: {
                title: "ğŸš¶ Homo Erectus (Barcode 9)",
                html: '<p>Fosil pertama ditemukan <strong>Eugene Dubois (1891)</strong> di Trinil, Jawa Timur. Hidup <strong>1,5 juta - 300 ribu tahun lalu</strong>.</p><h2>Ciri Fisik</h2><ul><li>Tinggi 160-170 cm, tubuh tegap</li><li>Otak 750-1.200 cc</li><li>Dahi miring, alis tebal</li><li>Berjalan tegak sepenuhnya</li></ul><h2>Kemajuan</h2><ul><li>Membuat <strong>alat batu</strong> (kapak genggam)</li><li><strong>Menguasai api</strong> pertama kali</li><li>Pakai <strong>kulit binatang</strong> sebagai pakaian</li><li>Hidup <strong>berkelompok</strong></li></ul><p>Menunjukkan kesadaran sosial dan budaya awal.</p>'
            }
        };

        const markers = document.querySelectorAll('a-marker');
        
        markers.forEach(marker => {
            marker.addEventListener('markerFound', () => {
                const model = marker.querySelector('.ar-model');
                const objType = model.getAttribute('data-object');
                
                loading.style.display = 'none';
                markerVisible = true;
                activeModel = model;
                currentRotation = {x: -90, y: 0, z: 0};
                
                showInfo(objType);
            });

            marker.addEventListener('markerLost', () => {
                loading.style.display = 'block';
                loading.textContent = 'Marker hilang, cari marker untuk melanjutkan...';
                markerVisible = false;
                activeModel = null;
                infoOverlay.classList.remove('show');
            });
        });

        function showInfo(type) {
            const info = objInfo[type];
            if (info) {
                infoContent.innerHTML = '<h1>' + info.title + '</h1>' + info.html + '<button id="close-info">Tutup</button>';
                document.getElementById('close-info').onclick = () => infoOverlay.classList.remove('show');
                infoOverlay.classList.add('show');
            }
        }

        infoOverlay.addEventListener('click', (e) => {
            if (e.target.id === 'info-overlay') infoOverlay.classList.remove('show');
        });

        const sensitivity = 0.5;

        // MOUSE EVENTS - Rotasi 2 arah (horizontal + vertikal)
        scene.addEventListener('mousedown', (e) => {
            if (!markerVisible || !activeModel) return;
            isDragging = true;
            previousMouseX = e.clientX;
            previousMouseY = e.clientY;
        });

        scene.addEventListener('mousemove', (e) => {
            if (!isDragging || !markerVisible || !activeModel) return;
            
            const deltaX = e.clientX - previousMouseX;
            const deltaY = e.clientY - previousMouseY;
            
            currentRotation.y += deltaX * sensitivity;
            currentRotation.x += deltaY * sensitivity;
            
            // Batasi rotasi X agar tidak terlalu ekstrem
            currentRotation.x = Math.max(-180, Math.min(0, currentRotation.x));
            
            activeModel.setAttribute('rotation', 
                currentRotation.x + ' ' + currentRotation.y + ' ' + currentRotation.z);
            
            previousMouseX = e.clientX;
            previousMouseY = e.clientY;
        });

        scene.addEventListener('mouseup', () => { isDragging = false; });

        // TOUCH EVENTS - Rotasi 2 arah (horizontal + vertikal)
        scene.addEventListener('touchstart', (e) => {
            if (!markerVisible || !activeModel || e.touches.length !== 1) return;
            isDragging = true;
            previousMouseX = e.touches[0].clientX;
            previousMouseY = e.touches[0].clientY;
            e.preventDefault();
        }, {passive: false});

        scene.addEventListener('touchmove', (e) => {
            if (!isDragging || !markerVisible || !activeModel || e.touches.length !== 1) return;
            
            const deltaX = e.touches[0].clientX - previousMouseX;
            const deltaY = e.touches[0].clientY - previousMouseY;
            
            currentRotation.y += deltaX * sensitivity;
            currentRotation.x += deltaY * sensitivity;
            
            // Batasi rotasi X agar tidak terlalu ekstrem
            currentRotation.x = Math.max(-180, Math.min(0, currentRotation.x));
            
            activeModel.setAttribute('rotation', 
                currentRotation.x + ' ' + currentRotation.y + ' ' + currentRotation.z);
            
            previousMouseX = e.touches[0].clientX;
            previousMouseY = e.touches[0].clientY;
            e.preventDefault();
        }, {passive: false});

        scene.addEventListener('touchend', () => { isDragging = false; });

        setTimeout(() => { 
            loading.textContent = 'Cari barcode marker (0-9) dengan kamera untuk memulai...'; 
        }, 2000);
    </script>
</body>
</html>
